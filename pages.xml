<?xml version="1.0" encoding="UTF-8" ?>
<site>
	{% set news = model.get('/test/_design/share-view/_view/news?include_docs=true&descending=true') %}
	<page>
		<url>/</url>
		<context type="json">
			{{ json.dumps( dict(
				news = group(
					news.rows,
					('key', 1),
					('key', 2)
				)
			)) }}
		</context>
		<template>home.html</template>
	</page>

	{% for row in model.get('/test/_design/share-view/_view/share-list?include_docs=true').rows %}
	<page>
		<url>/share/{{ row.id }}/</url>
		<context>
			{{
				model.get(
					api = '/test/_design/share-view/_view/share?keys=["' + row.id +'"]&include_docs=true',
					immutable = True
				)
			}}
		</context>
		<template>document.html</template>
	</page>
	{% endfor %}
</site>
